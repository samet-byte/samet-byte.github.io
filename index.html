<!DOCTYPE HTML>
<html>
<head>

<title>Sam</title>
 <link rel = "icon" href = 
"https://www.nicepng.com/png/full/24-242409_lemon-icon-icono-limon.png"
        type = "image/x-icon">
</head>
  
  
<style>
    table, th, td 
    {
      margin:10px 0;
      border:solid 1px #333;
      padding:2px 4px;
      font:15px Verdana;
    }
    th {
      font-weight:bold;
    }
    
#loader {
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid blue;
  border-bottom: 16px solid blue;
  width: 60px;
  height: 60px;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
  visibility:hidden;
}

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
    
  </style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>


<script>
  
  var script_url = 
    "https://script.google.com/macros/s/AKfycbyC3DhA18Fc9FvNMTBFBXGmnyBXXUORMLUWi6T2gYKIDV7SJHUYTy_v1lJesEN9SBkP/exec"
  ;  
  // Make an AJAX call to Google Script
  function insert_value() {
  
  $("#re").css("visibility","hidden");
   document.getElementById("loader").style.visibility = "visible";
  $('#mySpinner').addClass('spinner');

  var ID1  = $("#ID").val();
  var NAME = $("#NAME").val();
  var TITLE  = $("#TITLE").val();
  var DESCRIPTION  = $("#DESCRIPTION").val();
  var BG_IMAGE_URL  = $("#BG_IMAGE_URL").val();
  var CARD_IMAGE_URL  = $("#CARD_IMAGE_URL").val();
  var VIDEO_URL  = $("#VIDEO_URL").val();
  var GENRE  = $("#GENRE").val();
  var MOVIE_CATEGORY  = $("#MOVIE_CATEGORY").val();
  var WATCHLIST  = $("#WATCHLIST").val();
  var RATING  = $("#RATING").val();
  
  
  
  var url = script_url+"?callback=ctrlq"
  +"&ID="+$("#ID").val()
  +"&TITLE="+$("#TITLE").val()
  +"&DESCRIPTION="+DESCRIPTION
  +"&BG_IMAGE_URL="+BG_IMAGE_URL
  +"&CARD_IMAGE_URL="+CARD_IMAGE_URL
  +"&VIDEO_URL="+VIDEO_URL
  +"&GENRE="+GENRE
  +"&MOVIE_CATEGORY="+MOVIE_CATEGORY
  +"&WATCHLIST="+WATCHLIST
  +"&RATING="+RATING
  +"&action=insert";
  

  var request = jQuery.ajax({
    crossDomain: true,
    url: url ,
    method: "GET",
    dataType: "jsonp"
  });

  }


  
  
 
  
  
  function update_value(){
  $("#re").css("visibility","hidden");
   document.getElementById("loader").style.visibility = "visible";
  
  var ID1  = $("#ID").val();
  var NAME = $("#NAME").val();
  var TITLE  = $("#TITLE").val();
  var DESCRIPTION  = $("#DESCRIPTION").val();
  var BG_IMAGE_URL  = $("#BG_IMAGE_URL").val();
  var CARD_IMAGE_URL  = $("#CARD_IMAGE_URL").val();
  var VIDEO_URL  = $("#VIDEO_URL").val();
  var GENRE  = $("#GENRE").val();
  var MOVIE_CATEGORY  = $("#MOVIE_CATEGORY").val();
  var WATCHLIST  = $("#WATCHLIST").val();
  var RATING  = $("#RATING").val();
  
  var url = script_url+"?callback=ctrlq"
  +"&ID="+$("#ID").val()
  +"&TITLE="+$("#TITLE").val()
  +"&DESCRIPTION="+DESCRIPTION
  +"&BG_IMAGE_URL="+BG_IMAGE_URL
  +"&CARD_IMAGE_URL="+CARD_IMAGE_URL
  +"&VIDEO_URL="+VIDEO_URL
  +"&GENRE="+GENRE
  +"&MOVIE_CATEGORY="+MOVIE_CATEGORY
  +"&WATCHLIST="+WATCHLIST
  +"&RATING="+RATING
  +"&action=update";

  var request = jQuery.ajax({
    crossDomain: true,
    url: url ,
    method: "GET",
    dataType: "jsonp"
  });

  
  }

  
 
  
  
  function delete_value(){
  $("#re").css("visibility","hidden");
   document.getElementById("loader").style.visibility = "visible";
  $('#mySpinner').addClass('spinner');
  var id1=$("#ID").val();
  
  var url = script_url+"?callback=ctrlq&ID="+id1+"&action=delete";
  
  var request = jQuery.ajax({
    crossDomain: true,
    url: url ,
    method: "GET",
    dataType: "jsonp"
  });

  }


  
  
  // print the returned data
  function ctrlq(e) {
  
  
  $("#re").html(e.result);
  $("#re").css("visibility","visible");
  read_value();
  
  }
  
  

  
function read_value() {
$("#re").css("visibility","hidden");
   
   document.getElementById("loader").style.visibility = "visible";
   var url = script_url+"?action=read";

$.getJSON(url, function (json) {
  // Set the variables from the results array
   
    // CREATE DYNAMIC TABLE.
    var table = document.createElement("table");

    var header = table.createTHead();
    var row = header.insertRow(0);     
    var cell1 = row.insertCell(0);
    var cell2 = row.insertCell(1);
    var cell3 = row.insertCell(2);
    var cell4 = row.insertCell(3);
    var cell5 = row.insertCell(4);
    var cell6 = row.insertCell(5);
    var cell7 = row.insertCell(6);
    var cell8 = row.insertCell(7);
    var cell9 = row.insertCell(8);
    var cell10= row.insertCell(9);
    
    cell1.innerHTML = "<b>ID</b>";
    cell2.innerHTML = "<b>TITLE</b>";
    cell3.innerHTML = "<b>DESCRIPTION</b>";
    cell4.innerHTML = "<b>BG_IMAGE_URL</b>";
    cell5.innerHTML = "<b>CARD_IMAGE_URL</b>";
    cell6.innerHTML = "<b>VIDEO_URL</b>";
    cell7.innerHTML = "<b>GENRE</b>";
    cell8.innerHTML = "<b>MOVIE_CATEGORY</b>";
    cell9.innerHTML = "<b>WATCHLIST</b>";
    cell10.innerHTML = "<b>RATING</b>";
    
    // ADD JSON DATA TO THE TABLE AS ROWS.
    for (var i = 0; i < json.records.length; i++) {

      tr = table.insertRow(-1);
        var tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].ID;
        tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].TITLE;
        tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].DESCRIPTION;
        tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].BG_IMAGE_URL;
        tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].CARD_IMAGE_URL;
        tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].VIDEO_URL;
        tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].GENRE;
        tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].MOVIE_CATEGORY;
        tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].WATCHLIST;
        tabCell = tr.insertCell(-1);
        tabCell.innerHTML = json.records[i].RATING;
      }
    
    // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
    var divContainer = document.getElementById("showData");
    divContainer.innerHTML = "";
    divContainer.appendChild(table);
    document.getElementById("loader").style.visibility = "hidden";
    $("#re").css("visibility","visible");
  });
  }
  
  </script>

  
</head>
<style>
//	p{white-space: pre-line;}
  
</style>
<body BGCOLOR="BLACK" TEXT="WHITE">
<div align="center">
  <h1>HEADER</h1> 
<h2>CRUD OPERATION ON GOOGLE SPREAD SHEET, WEB APPLICATION USING GOOGLE APP SCRIPT</h2> 
<p>This is simple application.
  You can develop your own logic based on your requirements.</p>
<p>Be careful with the parameters you are sending,
  it should match the parameters that are received in google app script.</p>


<form >
  <pre>
    
    <input type = "text" name ="ID" id="ID" placeholder="ID"  text="abc"
    style="text-align: center"
    >
    <input type = "text" name ="TITLE" id="TITLE" placeholder="TITLE" style="text-align: center"
    >
    <input type = "text" name ="DESCRIPTION" id="DESCRIPTION" placeholder="DESCRIPTION" style="text-align: center"
    >
    <input type = "text" name ="BG_IMAGE_URL" id="BG_IMAGE_URL" placeholder="BG_IMAGE_URL" style="text-align: center"
    >
    <input type = "text" name ="CARD_IMAGE_URL" id="CARD_IMAGE_URL" placeholder="CARD_IMAGE_URL" style="text-align: center"
    >
    <input type = "text" name ="VIDEO_URL" id="VIDEO_URL" placeholder="VIDEO_URL" style="text-align: center"
    >
    <input type = "text" name ="GENRE" id="GENRE" placeholder="GENRE" style="text-align: center"
    >
    <input type = "text" name ="MOVIE_CATEGORY" id="MOVIE_CATEGORY" placeholder="MOVIE_CATEGORY" style="text-align: center"
    >
    <input type = "text" name ="WATCHLIST" id="WATCHLIST" placeholder="WATCHLIST" style="text-align: center"
    >
    <input type = "text" name ="RATING" id="RATING" placeholder="RATING" style="text-align: center"
    >
  </pre>

</form>

<div id="loader"></div>

<p id="re"></p>




<input type = "button"  id = "b1" onClick="insert_value()" value = "Insert"></input>
<input type="button" onclick="read_value()" value="Read" />
<input type="button" onclick="update_value()" value="Update" />
<input type="button" onclick="delete_value()" value="Delete" />
<a href=
"https://docs.google.com/spreadsheets/d/1dUoMkJXCeHwUu43pfX7MKCpEy7z2HGi6Cz_hrAzvdWA/edit#gid=0"
 target="_blank">Click here to open Spread Sheet </a>
<div id="showData"></div>
</div>
</body>
<div align="center">
<p> 2022 | All Rights Reserved</p>
</div>
<html>
